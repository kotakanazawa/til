これを読んでいく。
[\[ActiveRecord\] 複数のモデルにまたがる処理を書きたいときの設計方法](https://zenn.dev/igaiga/books/rails-practice-note/viewer/ar_processing_across_multiple_models)

複数のモデルにまたがる処理を実装したいときは、基本的に以下の3つを検討する。

- 主となるモデルに実装をする
- イベント型モデルを探す
- POROを作る

## 主となるモデルに実装をする

例えば、ECサービスのカートを実装する場合。

- Cartモデル：ユーザーごとのカートを管理する責務を持つ
- CartItemモデル：カート内の個々の商品を管理する責務を持つ

ある特定の商品を値引きするクーポンがあったとき、これを適用するのはCartモデルか、CartItemモデル、どちらにすべきか？
このときに、

- Cartモデル：主
- CartItemモデル：従

という関係性があると考えて、Cartモデルの責務としてクーポン適用のメソッドを実装するのが「主となるモデルに実装をする」方法となる。
この場合、おそらく`Cart has-many CartItem`という関係になるはず。

主となるモデルに実装をするメリット：

- モデルを増やさずに済む

まずこれで始めて、開発していく中でメソッドが増えてきてから分割や、「イベント型モデル」や「POROをつくる」をやっていく。最初からこの2つをやるのは難しい。

デメリット：

主従関係にあるか考えづらいモデル間ではどちらのモデルへ実装したらいいか迷う。
